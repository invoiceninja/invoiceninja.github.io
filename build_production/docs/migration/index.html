<!DOCTYPE html>
<html lang="en">

<head>
    <title>Free Open-Source Invoicing, Expenses &amp; Time-Tracking | Invoice Ninja</title>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="referrer" content="always">
    <link rel="canonical" href="https://invoiceninja.github.io/docs/migration">
    <meta name="description" content="The leading free open-source online invoicing app for freelancers &amp; businesses. Invoice, accept payments, track expenses, create proposals, &amp; time-tasks">

    <link rel="stylesheet" href="/assets/build/css/main.css?id=098343128cd16893e85d">

    </head>

<nav class="py-4 sticky top-0 z-40 lg:z-50 w-full mx-auto bg-white border-b">
    <div id="navigation-content" class="flex items-center justify-between px-4 md:px-0 md:mx-auto max-w-8xl">
        <a href="/" id="left-side-logo">
            <img class="h-8"
                 src="/assets/images/logo.png"
                 alt="Invoice Ninja logo"/>
        </a>
        <section id="right-side-items" class="text-sm">
            <div class="hidden md:block md:space-x-5">
                <input type="text" placeholder="Quick search..."
                       class="px-4 py-2 border rounded hover:border-ninja-blue focus:border-ninja-blue focus:outline-none">
                <a href="/docs/getting-started" class="py-2 border-b border-transparent hover:border-ninja-blue">Documentation</a>
                <a href="https://app.swaggerhub.com/apis/invoiceninja/invoiceninja" target="_blank"
                   class="py-2 border-b border-transparent hover:border-ninja-blue">API Documentation</a>
                <a href="https://app.invoiceninja.com" class="px-5 py-2 border rounded-full hover:border-ninja-blue">Go
                    to app</a>
            </div>
            <div class="flex flex-col md:hidden">
                <button id="mobile-menu-toggle" class="focus:outline-none">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                         class="feather feather-menu">
                        <line x1="3" y1="12" x2="21" y2="12"></line>
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="3" y1="18" x2="21" y2="18"></line>
                    </svg>
                </button>
            </div>
        </section>
    </div>
    <div id="mobile-menu" class="hidden px-4 pt-4 flex flex-col">
        <a href="/docs/getting-started"
           class="py-2 border-b border-transparent hover:border-ninja-blue">Documentation</a>
        <a href="https://app.swaggerhub.com/apis/invoiceninja/invoiceninja" target="_blank"
           class="py-2 border-b border-transparent hover:border-ninja-blue">API Documentation</a>
        <a href="https://app.invoiceninja.com" target="_blank"
           class="py-2 border-b border-transparent hover:border-ninja-blue">Go to app</a>
    </div>
</nav>
<body class="font-sans antialiased text-gray-900 bg-white ">
        <div class="max-w-8xl grid grid-cols-12 md:gap-16 py-4 mx-auto">
        <div class="hidden mr-4 space-y-6 md:block lg:col-span-2">
            <div class="hidden md:block fixed mt-2">
                                    <div clasS="mb-8">
                        <a class="block hover:text-ninja-blue font-semibold uppercase "
                           href="/docs/getting-started">User guide</a>

                        <div class="mt-2">
                                                            <a class="block hover:text-ninja-blue py-1 "
                                   href="/docs/introduction">Introduction</a>
                                                            <a class="block hover:text-ninja-blue py-1 "
                                   href="/docs/clients">Clients</a>
                                                            <a class="block hover:text-ninja-blue py-1 "
                                   href="/docs/products">Products</a>
                                                            <a class="block hover:text-ninja-blue py-1 "
                                   href="/docs/invoices">Invoices</a>
                                                            <a class="block hover:text-ninja-blue py-1 "
                                   href="/docs/payments">Payments</a>
                                                            <a class="block hover:text-ninja-blue py-1 "
                                   href="/docs/settings">Settings</a>
                                                    </div>
                    </div>
                                    <div clasS="mb-8">
                        <a class="block hover:text-ninja-blue font-semibold uppercase "
                           href="/docs/developer-guide">Developer guide</a>

                        <div class="mt-2">
                                                    </div>
                    </div>
                                    <div clasS="mb-8">
                        <a class="block hover:text-ninja-blue font-semibold uppercase "
                           href="/docs/self-host">Self host</a>

                        <div class="mt-2">
                                                    </div>
                    </div>
                                    <div clasS="mb-8">
                        <a class="block hover:text-ninja-blue font-semibold uppercase text-ninja-blue border-ninja-blue"
                           href="/docs/migration">Migrating to V5</a>

                        <div class="mt-2">
                                                    </div>
                    </div>
                            </div>
        </div> <!-- End of sidebar -->

        <div class="col-span-12 md:col-span-7 p-4 prose mx-auto" style="max-width: 100% !important;" id="page-content">
            <h1>Migrating to V5</h1>

<h2>Preparing V4.</h2>

<p>The first step needed to prepare to migrate your data across to your new V5 installation is to update your V4 installation to the latest version available. This is a critical step and you will see problems migrating your data if you do not update to the latest V4.</p>

<h2>Installing V5.</h2>

<p>Installing V5 is covered in detail <a href="/docs/self-host">here</a> with resources to cover your needs for Docker / Shared Hosting or Ubuntu/Centos installations.</p>

<p>An important detail with your V5 installation is that your initial user login is identical to your V4 installation.</p>

<p>The migration relies heavily on the Laravel queue system, so you will need to ensure that you have configured the cron scheduler which boots the laravel queue for you. If you do not configure the cron scheduler, the migration will not work and you will end up with a blank company with no content.</p>

<h2>Starting the migration</h2>

<p><img src="/assets/images/migration/migration_step_1.png" alt="alt text" title="Start migration" /></p>

<p>Navigate to Settings > Account Management and scroll down until you see the Start Migration button.</p>

<p><img src="/assets/images/migration/migration_step_2.png" alt="alt text" title="Select self hosted" /></p>

<p>After clicking <code>Start migration</code>, you'll get another screen, simply select the self-host radio button and continue.</p>

<p><img src="/assets/images/migration/migration_step_3.png" alt="alt text" title="Enter URL" /></p>

<p>The next screen asks for the full qualified domain name of your V5 installation, enter this including the http:// or https:// in your URL, ie</p>

<p><code>http:://ninja.test</code></p>

<p><img src="/assets/images/migration/migration_step_4.png" alt="alt text" title="Authenticate" /></p>

<p>The next screen requires you to enter your login credentials, remembering that these should be identical between your V4 and V5 installation. You'll also notice an additional field <code>API_SECRET</code> this can be ignore if you do not have a value set for this in your <code>.env</code> file.</p>

<p>If you experience an error at this point, most likely either your credentials are wrong, or the URL you have entered is not correct.</p>

<p><img src="/assets/images/migration/migration_step_5.png" alt="alt text" title="Select company" /></p>

<p>If you successfully authenticate you'll see the next screen which allows you to select the companies you wish to migrate.</p>

<p>Important points at this stage:</p>

<ul>
<li>Force migration will overwrite an existing company that has already been migrated to V5, this is destructive and cannot be undone.</li>
<li>Just selecting the checkbox next to the company name will attempt a migration if the company has never been migrated to the V5 installation. This is a non-destructive migration. ie. it will not overwrite a matching company.</li>
</ul>

<p><img src="/assets/images/migration/migration_step_6.png" alt="alt text" title="Migration started" /></p>

<h2>V5 Migration Process</h2>

<p>With a little luck, you should have already received an email notification advising the migration has completed!</p>

<p>There are a couple of things you will want to check to ensure the data has come across correctly:</p>

<ul>
<li>Ensure your company logo has migrated (Settings > Company Details > Logo)</li>
<li>Ensure the migrated data passes our data quality check by running</li>
</ul>

<pre><code class="language-php">php artisan ninja:check-data
</code></pre>

<p>A series of checks are run and if you see 0 issues, that means your data has come across correctly.</p>

<ul>
<li>You'll also want to inspect the logs located in :</li>
</ul>

<pre><code class="language-bash">storage/logs/laravel.log
</code></pre>

<p>Inside here you will see output such as this:</p>

<pre><code class="language-bash">[2021-01-30 10:46:04] development.INFO: Importing account  
[2021-01-30 10:46:04] development.INFO: Importing company  
[2021-01-30 10:46:04] development.INFO: Importing users  
[2021-01-30 10:46:04] development.INFO: Importing payment_terms  
[2021-01-30 10:46:04] development.INFO: Importing tax_rates  
[2021-01-30 10:46:04] development.INFO: Importing clients  
[2021-01-30 10:46:04] development.INFO: Importing company_gateways  
[2021-01-30 10:46:04] development.INFO: Importing client_gateway_tokens  
[2021-01-30 10:46:04] development.INFO: Importing vendors  
[2021-01-30 10:46:04] development.INFO: Importing projects  
[2021-01-30 10:46:04] development.INFO: Importing products  
[2021-01-30 10:46:04] development.INFO: Importing credits  
[2021-01-30 10:46:04] development.INFO: Importing invoices  
[2021-01-30 10:46:06] development.INFO: Importing recurring_invoices  
[2021-01-30 10:46:06] development.INFO: Importing quotes  
[2021-01-30 10:46:07] development.INFO: Importing payments  
[2021-01-30 10:46:08] development.INFO: Importing expense_categories  
[2021-01-30 10:46:08] development.INFO: Importing task_statuses  
[2021-01-30 10:46:08] development.INFO: Importing expenses  
[2021-01-30 10:46:08] development.INFO: Importing tasks  
[2021-01-30 10:46:08] development.INFO: Importing documents  
[2021-01-30 10:46:09] development.INFO: CompletedðŸš€ðŸš€ðŸš€ðŸš€ðŸš€ at 2021-01-30 
[2021-01-30 10:46:09] development.INFO: latest version = 5.0.56  
</code></pre>

<p>This example output would indicate that each entity was successfully brought across, if a problem is detected early the migration will fail early and return an error. A Laravel error will also be thrown indicating the exact issue.</p>

<h2>Troubleshooting</h2>

<p>If you are experiencing issues with the migration not running as expected please run through the following checklist:</p>

<ul>
<li>Ensure directories are read/writable by the webuser (ie www-data)</li>
<li>Ensure the cron scheduler is running (and working) - You can verify it is working by inspecting the <code>jobs</code> table in the database, it should be empty</li>
<li>Inspect the log file /storage/logs/laravel.log for further information.</li>
<li>If you are still experiencing issues, turn on advanced logging by adding the following variable to your .env file. EXPANDED_LOGGING=true then optimize with php artisan optimize . Then attempt the migration again and afterwards inspect the log file in storage/logs/invoiceninja.log</li>
<li>Still having troubles? search the <a href="https://forum.invoiceninja.com">forum</a> or come and chat with us on <a href="https://invoiceninja.slack.com">slack</a></li>
</ul>

            <a href="https://github.com/invoiceninja/invoiceninja.github.io/blob/master/source/docs/migration.md"
               class="pt-4 border-t inline-flex items-center w-full block">
                <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" viewBox="0 0 24 24" fill="none"
                     stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                     class="feather feather-github">
                    <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
                </svg>
                <span class="ml-2">Want to contribute? Edit this page on GitHub!</span>
            </a>
        </div> <!-- End of main content -->

        <div class="hidden md:block col-span-3 p-4">
            <div class="fixed" id="toc-container">
                <!-- Placeholder for table of contents -->
                <span class="text-sm uppercase block mb-3 text-ninja-blue">On this page</span>
            </div>
        </div>
    </div>
        <script src="/assets/build/js/main.js?id=f8ae428c8ff7fbb77216"></script>

    <script>
        document.getElementById('mobile-menu-toggle').addEventListener('click', () => {
            let mobileMenu = document.getElementById('mobile-menu');

            if (mobileMenu.classList.contains('hidden')) {
                return mobileMenu.classList.remove('hidden');
            }

            return mobileMenu.classList.add('hidden');
        });
    </script>
</body>

</html>
